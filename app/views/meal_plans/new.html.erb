<div class="container">
  <h6 class="text-muted pt-3" style="font-size: 17px;">Choose your preferences</h6>
  <div class="row m-1 mb-3">

<% @top_choices.each do |choice| %>

<% next if Preference.exists?(tag_id: choice.id, user_id: current_user.id, kind: -1, active: true) || choice.name == 'sustainable' || choice.name == 'cheap'|| choice.name == 'veryPopular'%>

<div class="col-6 col-lg-2 col-md-3 col-sm-4 p-1">

  <% if Preference.exists?(tag_id: choice.id, user_id: current_user.id, kind: 1, active: true) %>
    <% pref = Preference.find_by(tag_id: choice.id, active: true) %>
    <form class="form-inline" >
      <%= link_to preference_deactivate_path(pref), { class: "btn-sm btn-secondary w-100 text-center", method: "patch",  style: "text-decoration:none;" } do %>
        <span><%= choice.name %></span>
      <% end %>
    </form>

  <% else %>

    <form class="form-inline" >
      <%= link_to preference_tag_path(choice, kind: 1), { class: "btn-outline-secondary btn-sm w-100 text-center", method: "post",  style: "text-decoration:none; border:1px solid;"} do %>
        <span><%= choice.name %></span>
      <% end %>
    </form>

  <% end %>

</div>

<% end %>

<div class="col-6 col-lg-2 col-md-3 col-sm-4 pt-2 pl-4">
    <a class="font-c-3" href='/preferences'>
      <u>More choices</u>
      <i class="fas fa-long-arrow-alt-right mr-1"></i>
    </a>
</div>


</div>
  <h6 class="text-muted mb-1" style="font-size: 17px;">Choose the number of days</h6>
<%= simple_form_for @meal_plan do |f| %>
  <div class="row d-flex justify-content-center change_color">
    <div class="column mt-1" style ="width:87%;">
          <%= f.input :days, required: true, label: false, error: 'Please tell me how many days you want to cook?', input_html: { class: 'is-valid', id: 'range_slider', min: '1', max: '14', step: 'any'}, as: :range%>
    </div>
    <div class="column">
      <a id="range_slider_value" class="ml-3 mt-3" style="color:black;">7</a>
    </div>

  </div>
  <%= f.submit "Generate New Meal Plan", class: "btn btn-primary w-100 mb-3"%>
<% end %>

<% unless @plan.nil? %>
<% @plan.meals.order(id: :desc).each do |meal|%>
<div class="my-2">
  <div class="card-meal">
     <div class="d-flex" >
      <div class="align-self-center", style="height: 120px" >
        <img width=100 src="<%=  meal.recipe.image_url %> ">
      </div>
        <div class="col-8 card-meal-infos lefty-border">
          <div class="details">
          <h3 class="font-c-6 mt-3"> <%= link_to meal.recipe.name.truncate(24), recipe_path(meal.recipe) %> </h3>
            <div class="pl-1 desc-size ">
            <h5 class="font-c-neutral text-left text-secondary"><i class="fas fa-clock pr-1"></i> <%= meal.recipe.prep_time %> minutes</h5>
            <p class="overflow-ellipsis"> <%= meal.recipe.description.html_safe.truncate(24) %> </p>
            </div>
            <div class="btn-form-wrapper" grid-column-end: foo;>
              <form class="form-row">
                <div class="shuffle-btn">
                  <%= link_to shuffle_path(meal), { class: "shuffle", remote: true, method: 'post' } do %><i class="fa fa-redo" aria-hidden="true"></i><% end %>
                </div>
                <div class="remove-btn">
                  <%= link_to meal_path(meal), { class: "delete", remote: true, method: 'delete',  style: "text-decoration:none;" } do %><i class="far fa-trash-alt" aria-hidden="true"></i><% end %>
                </div>
              </form>
            </div>
          </div>
        </div>
       </div>
    </div>
<div>
<% end %>
  <%= link_to 'To My Shopping List', meal_plan_shopping_list_items_path(@plan), {class: "btn btn-danger mt-3 w-100"}  %>
<% end %>
<!-- /meal_plans/:meal_plan_id/shopping_list_items/
, {class: "btn btn-secondary"} -->

</div>
<br>
