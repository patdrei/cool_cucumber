<div class="container">
  <h6 class="text-muted pt-3" style="font-size: 17px;">Choose your preferences</h6>
  <div class="row m-1 mb-3">

<% @top_choices.each do |choice| %>

<% next if Preference.exists?(tag_id: choice.id, user_id: current_user.id, kind: -1, active: true) || choice.name == 'sustainable' || choice.name == 'cheap'|| choice.name == 'veryPopular'%>

<div class="col-6 col-lg-2 col-md-3 col-sm-4 p-1">

  <% if Preference.exists?(tag_id: choice.id, user_id: current_user.id, kind: 1, active: true) %>
    <% pref = Preference.find_by(tag_id: choice.id, active: true) %>
    <form class="form-inline" >
      <%= link_to preference_deactivate_path(pref), { class: "btn-sm btn-secondary w-100 text-center", method: "patch",  style: "text-decoration:none;" } do %>
        <span><%= choice.name %></span>
      <% end %>
    </form>

  <% else %>

    <form class="form-inline" >
      <%= link_to preference_tag_path(choice, kind: 1), { class: "btn-outline-secondary btn-sm w-100 text-center", method: "post",  style: "text-decoration:none; border:1px solid;"} do %>
        <span><%= choice.name %></span>
      <% end %>
    </form>

  <% end %>

</div>

<% end %>
<div class="col-6 col-lg-2 col-md-3 col-sm-4 p-1">
    <form class="form-inline" >
      <%= link_to overview_path, { class: "btn-primary btn-sm w-100 text-center", method: "get",  style: "text-decoration:none;"} do %>
        <span> More choices </span>
      <% end %>
    </form>
</div>
</div>


<%= simple_form_for [@meal_plan] do |f| %>
<div class="text-muted">
  <%= f.input :days, required: true, label: 'For how many Days?', error: 'Please tell me how many days you want to cook?', input_html: { min: '1', max: '7', step: 'any'}%>
</div>
  <%= f.submit "Generate New Meal Plan", {class: "btn btn-primary w-100 mb-3", remote: true}%>
<% end %>




<% unless @plan.nil? %>
<% @plan.meals.order(id: :desc).each do |meal|%>
<div class="my-2">
  <div class="card-meal">
     <div class="d-flex" >
      <div class="align-self-center", style="height: 120px" >
        <img width=100 src="<%=  meal.recipe.image_url %> ">
      </div>
        <div class="col-8 card-meal-infos lefty-border">
          <h3 class="font-c-6 mt-3"> <%= link_to meal.recipe.name, recipe_path(meal.recipe) %> </h3>
            <div class="pl-3 desc-size ">
            <h5 class="font-c-neutral text-left text-secondary"><i class="fas fa-clock pr-1"></i> <%= meal.recipe.prep_time %> minutes</h5>
            <p class="overflow-ellipsis"> <%= meal.recipe.description.html_safe %> </p>
          </div>
        </div>
      </div>
    </div>
        <form class="form-inline" >
      <%= link_to shuffle_path(meal), { class: "btn-sm btn-secondary w-100 text-center", method: "post",  style: "text-decoration:none;" } do %>
        <span>Shuffle</span>
      <% end %>
    </form>
<% end %>
  <%= link_to 'To My Shopping List', meal_plan_shopping_list_items_path(@plan), {class: "btn btn-danger mt-3 w-100"}  %>
<% end %>
<!-- /meal_plans/:meal_plan_id/shopping_list_items/
, {class: "btn btn-secondary"} -->

</div>
<br>



