<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
<body>
  <% if params[:category] == "cuisines"  %>
      <% i = '-danger' %>
    <% elsif params[:category] == "top_choices" %>
      <% i = '-secondary'  %>
    <% elsif params[:category] == "dish_types"%>
      <% i = '-info'  %>
    <% else%>
      <% i = '-warning' %>
  <% end %>

  <div class="m-3">

    <div class="justify-content-center p-1 mb-3">
    <%= form_tag preferences_ingredients_path, method: :get do %>
      <%= text_field_tag :query,
        params[:query],
        class: "form-control w-80",
        placeholder: "Find ingredient"
      %>
      <%#= submit_tag "Find", class: "font-c-5" %>
    <% end %>
    </div>

    <% if @pure_ingredients.nil? %>

    <% @ingredients.each_with_index do |array, i| %>
          <h4 class="mt-3">
            <%= @alphabet[i].capitalize  %></h4>
          <div class="row p-1 mb-3">
            <% array.each do |ingredient| %>
            <% next if Preference.exists?(ingredient_id: ingredient.id, user_id: current_user.id, kind: -1, active: true) %>
            <div class="col-6 col-lg-2 col-md-3 col-sm-4 p-1">
              <% if Preference.exists?(ingredient_id: ingredient.id, user_id: current_user.id, kind: 1, active: true) %>
                <% pref = Preference.find_by(ingredient_id: ingredient.id, active: true) %>
                <form class="form-inline" >
                  <%= link_to preference_deactivate_path(pref), { class: "btn-sm btn#{i} w-100 text-center inc-pref", method: "patch",  style: "text-decoration:none;", remote: true} do %>
                    <span><%= ingredient.name %></span>
                  <% end %>
                </form>

              <% else %>

                <form class="form-inline" >
                  <%= link_to preference_ingredient_path(ingredient, kind: 1), { class: "btn-sm btn-outline#{i} w-100 text-center no-pref", method: "post",  style: "text-decoration:none; border:1px solid;", remote: true} do %>
                    <span><%= ingredient.name %></span>
                  <% end %>
                </form>

              <% end %>

            </div>

            <% end %>
            </div>
          <% end %>




    <%  else %>

    <div class="row p-1 mb-3">
            <% @pure_ingredients.each do |ingredient| %>
            <% next if Preference.exists?(ingredient_id: ingredient.id, user_id: current_user.id, kind: -1, active: true) %>
            <div class="col-6 col-lg-2 col-md-3 col-sm-4 p-1">
              <% if Preference.exists?(ingredient_id: ingredient.id, user_id: current_user.id, kind: 1, active: true) %>
                <% pref = Preference.find_by(ingredient_id: ingredient.id, active: true) %>
                <form class="form-inline" >
                  <%= link_to preference_deactivate_path(pref), { class: "btn-sm btn#{i} w-100 text-center inc-pref", method: "patch",  style: "text-decoration:none;", remote: true} do %>
                    <span><%= ingredient.name %></span>
                  <% end %>
                </form>

              <% else %>

                <form class="form-inline" >
                  <%= link_to preference_ingredient_path(ingredient, kind: 1), { class: "btn-sm btn-outline#{i} w-100 text-center no-pref", method: "post",  style: "text-decoration:none; border:1px solid;", remote: true} do %>
                    <span><%= ingredient.name %></span>
                  <% end %>
                </form>

              <% end %>

            </div>

            <% end %>
      </div>


  </div>
      <%  end %>
</body>
</html>
